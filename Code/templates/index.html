{% extends "base.html" %}
{% block content %}

<!-- Hero -->
<div class="hero">
  <div>
    <h1 class="app-name">Interviewly</h1>
    <div class="accent"></div>
    <p class="subtitle">Track your applications at a glance.</p>
  </div>
</div>

<!-- Tiles -->
<div class="tiles-row">
  <a href="{{ url_for('applications.list_applications') }}" class="tile tile-dark1">
    <div class="tile-title">Applications</div>
    <div class="tile-number">{{ rows|length }}</div>
    <div class="tile-hint">View & update</div>
  </a>

  <a href="{{ url_for('stats.stats') }}" class="tile tile-dark2">
    <div class="tile-title">Stats</div>
    <div class="tile-number">{{ counts['Accepted'] }}/{{ total }}</div>
    <div class="tile-hint">Progress & charts</div>
  </a>
</div>

<!-- Status overview -->
<div class="card">
  <div class="card-header">
    <h2 class="section-title">Status overview</h2>
    <a href="{{ url_for('stats.stats') }}" class="header-link">View charts â†’</a>
  </div>

  <div class="status-list">
    {% set order = ['Pending','Interview','Accepted','Rejected','No Answer'] %}
    {% for label in order %}
      {% set value = counts[label] %}
      {% set pct = (value / total * 100) if total else 0 %}
      <a href="{{ url_for('applications.list_applications', filter=label) }}" class="status-row">
        <div class="status-left">
          <span class="status-pill {{ label|lower|replace(' ','') }}">{{ label }}</span>
          <span class="count-text">{{ value }}</span>
        </div>
        <div class="bar-track">
          <!-- use CSS var to avoid linter error -->
          <div class="bar-fill {{ label|lower|replace(' ','') }}"
               style="--w: {{ '%.2f'|format(pct) }}%;"></div>
        </div>
      </a>
    {% endfor %}
  </div>
</div>

<!-- Recent updates -->
<div class="card">
  <h2 class="section-title">Recent updates</h2>
  {% if rows|length == 0 %}
    <p class="muted">Nothing yet. Add your first application.</p>
  {% else %}
    {% for r in rows[:5] %}
      <div class="row">
        <div>
          <div class="itemTitle">{{ r.position }}</div>
          <div class="itemSub">{{ r.company }}</div>
        </div>
        <span class="status-pill {{ r.status|lower|replace(' ','') }}">{{ r.status }}</span>
      </div>
    {% endfor %}
  {% endif %}
</div>

<!-- Quick actions -->
<div class="actions">
  <a href="{{ url_for('applications.list_applications') }}" class="btn">My Applications</a>
  <a href="{{ url_for('applications.new') }}" class="btn-outline">Add New</a>
</div>

{% endblock %}
